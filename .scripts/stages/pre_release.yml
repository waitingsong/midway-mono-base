
pre_release:
  stage: pre-release
  tags:
    - worker
  only:
    - master
  except:
    variables:
      - $CI_COMMIT_MESSAGE =~ /^v\d+(\.\d+){2}.*/
  cache: {}
  variables:
    GIT_STRATEGY: clone
  script:
    - echo -e "\e[0Ksection_start:`date +%s`:pre_release_section[collapsed=true]\r\e[0K Pre Release"
    - sh .scripts/ci/ci-pre-publish.sh
    - echo -e "\e[0Ksection_end:`date +%s`:pre_release_section\r\e[0K"
  # true for no blocked status
  allow_failure: true
  when: manual

